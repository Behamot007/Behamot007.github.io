<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Twitch Chat Steuerung</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="app-header__brand">
        <span class="app-header__logo">üõ†Ô∏è</span>
        <div>
          <h1>Twitch Chat Steuerung</h1>
          <p>Bot-Kanal √ºberwachen &amp; Nachrichten versenden</p>
        </div>
      </div>
      <nav class="app-header__nav">
        <a href="../../index.html">‚Üê Zur√ºck zur √úbersicht</a>
      </nav>
    </header>

    <main class="app-main">
      <nav class="page-nav" aria-label="Bereiche">
        <button type="button" class="page-nav__link is-active" data-target="config" id="nav-config">
          Konfiguration
        </button>
        <button type="button" class="page-nav__link" data-target="chat" id="nav-chat">
          Chat-Ansicht
        </button>
        <button type="button" class="page-nav__link" data-target="commands" id="nav-commands">
          Befehle
        </button>
      </nav>

      <section class="page-section is-active" id="view-config" aria-labelledby="nav-config">
        <div class="cards-grid">
          <article class="card">
            <h2>Backend-Verbindung</h2>
            <form id="connectionForm" class="form-grid" method="post" autocomplete="on">
              <label>
                <span>API Benutzername (optional)</span>
                <input
                  id="apiUser"
                  name="username"
                  type="text"
                  placeholder="z. B. bot-admin"
                  autocomplete="username"
                />
              </label>
              <label>
                <span>API-Passwort</span>
                <input
                  id="apiPassword"
                  name="password"
                  type="password"
                  autocomplete="current-password"
                  required
                />
              </label>
              <div class="form-actions">
                <button type="submit">Verbinden</button>
                <button type="button" id="clearPassword" class="secondary">Passwort l√∂schen</button>
              </div>
            </form>
            <div id="connectionStatus" class="status-box">Nicht verbunden</div>
          </article>

          <article class="card">
            <h2>OAuth f√ºr Bot-Token</h2>
            <p>
              Startet den Twitch-Login in einem Pop-up. Nach erfolgreicher Anmeldung wird das neue Bot-Token automatisch im
              Backend gespeichert und bei Bedarf erneuert.
            </p>
            <div class="oauth-grid">
              <button id="oauthStart" disabled>OAuth starten</button>
              <div class="status-box" id="oauthInfo">Noch kein Token angefordert.</div>
            </div>
          </article>

          <article class="card">
            <h2>Token-Status</h2>
            <div id="tokenStatus" class="status-box">Noch kein Bot-Token hinterlegt.</div>
            <p class="card__hint">
              Tipp: F√ºr automatische Verl√§ngerung muss beim OAuth-Login das H√§kchen f√ºr <code>chat:read</code> und
              <code>chat:edit</code> gesetzt sein.
            </p>
          </article>
        </div>
      </section>

      <section class="page-section" id="view-chat" aria-labelledby="nav-chat">
        <div class="cards-grid">
          <article class="card card--wide">
            <div class="card-header">
              <h2>Chat-Ansicht</h2>
              <div class="channel-form">
                <label>
                  <span>Channel</span>
                  <input id="channelInput" type="text" placeholder="beispielkanal" />
                </label>
                <button id="connectChannel" disabled>Chat abonnieren</button>
              </div>
            </div>
            <div id="chatLog" class="chat-log" aria-live="polite"></div>
            <form id="messageForm" class="message-form">
              <textarea id="messageInput" rows="2" placeholder="Nachricht schreiben..." required></textarea>
              <button type="submit" disabled>Senden</button>
            </form>
          </article>
        </div>
      </section>

      <section class="page-section" id="view-commands" aria-labelledby="nav-commands">
        <div class="cards-grid">
          <article class="card card--wide">
            <div class="card-header">
              <div>
                <h2>Befehlsverwaltung</h2>
                <p class="card__hint">
                  Lege einen Pr√§fix und individuelle Antworten fest. Platzhalter wie <code>{user}</code> oder
                  <code>{channel}</code> werden automatisch ersetzt.
                </p>
              </div>
              <div class="command-prefix">
                <label>
                  <span>Befehlspr√§fix</span>
                  <input id="commandPrefix" type="text" maxlength="5" />
                </label>
              </div>
            </div>
            <div id="commandList" class="command-list" aria-live="polite"></div>
            <div class="command-actions">
              <button type="button" id="addCommand" class="secondary">Neuen Befehl hinzuf√ºgen</button>
              <button type="button" id="saveCommands">√Ñnderungen speichern</button>
            </div>
            <div id="commandStatus" class="status-box">Befehle noch nicht geladen.</div>
          </article>
        </div>
      </section>
    </main>

    <template id="messageTemplate">
      <article class="chat-message">
        <div class="chat-message__meta">
          <span class="chat-message__user"></span>
          <time class="chat-message__time"></time>
        </div>
        <p class="chat-message__text"></p>
      </article>
    </template>

    <script type="module" src="./script.js"></script>
  </body>
</html>
